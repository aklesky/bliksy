version: 2.1
orbs:
    node: circleci/node@5.0.3

release:
    docker:
        - image: circleci/node
    resource_class: small
    steps:
      - checkout
      - node/with-cache:
          steps:
            - add_ssh_keys:
                fingerprints:
                  - "F1:NG:3R:PR:1N:T"
            - run: npx lerna bootstrap --ci
            - run: npx lerna version --no-private --conventional-commits --create-release github --yes
workflows:
  release-packages:
    jobs:
      - release:
          filtters:
            branches:
              only: master
